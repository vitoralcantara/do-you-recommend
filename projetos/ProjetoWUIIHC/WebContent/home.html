<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Quadro de Avisos</title>
<style type="text/css">@import url( style.css )</style>

<script type="text/javascript">

function deleteAllCookies() { 
    var cookies = document.cookie.split(";"); 
    for (var i = 0; i < cookies.length; i++) { 
    var cookie = cookies[i]; 
    var eqPos = cookie.indexOf("="); 
    var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie; 
    document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT"; 
    } 
    window.location.reload();
} 

function setCookie(c_name,value,expiredays)
{
	var exdate=new Date();
	exdate.setDate(exdate.getDate()+expiredays);
	document.cookie=c_name+ "=" +escape(value)+
	((expiredays==null) ? "" : ";expires="+exdate.toUTCString());
}

function deleteCookie(c_name)
{
	var exdate=new Date();
	document.cookie= c_name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
}

function editarDado(id){
	setCookie("editarContato","s",3);
	with(id){
		alert("Vendo ID: " + value);
		setCookie("contatoID",value,3);	
	}			
}

function getCookie(c_name)
{
if (document.cookie.length>0)
  {
  c_start=document.cookie.indexOf(c_name + "=");
  if (c_start!=-1)
    {
	    c_start=c_start + c_name.length+1;
	    c_end=document.cookie.indexOf(";",c_start);
	    if (c_end==-1) c_end=document.cookie.length;
	    	return unescape(document.cookie.substring(c_start,c_end));
    }
  }
return "";
}

function deletarContato(id){
	with(id){
		deleteCookie("autor" + value);
		deleteCookie("data" + value);
		deleteCookie("mensagem" + value);
	}	
	window.location.reload();
}

document.write("<p>Universidade Federal do Rio Grande do Norte<br>");
document.write("Centro de Ciências Exatas e da Terra<br>");
document.write("Departamento de Informática e Matemática Aplicada<br>");
document.write("Disciplina: Interação Humano-Computador – DIM0433<br>");
document.write("Profº: Jair Cavalcanti Leite<br>");
document.write("Aluno: Vítor Alcântara de Almeida<br>");
document.write("Matrícula: 2008018563</p>");	
document.write("<h1>Quadro de Avisos</h1>");
document.write("<table><tr><th>ID</th><th>Data</th><th>Autor</th><th>Mensagem</th><th></th><th></th></tr>");
	
var i = 0;
var pos;
var pos2;
var autorAtual;
var msgAtual;
var dataAtual;
var val;
var num;
var numString;
while(i < document.cookie.length - 1 && i != -1)
{
	
	pos = document.cookie.indexOf("autor", i);
	if(pos == -1){
		break;
	}	
	pos2 = document.cookie.indexOf("=",pos);
	if(pos2 == -1){
		break;
	}
			
	autorAtual = document.cookie.substring(pos,pos2);
	numString = document.cookie.substring(pos+5,pos2);
	autorAtual = getCookie(autorAtual);
	
	//i = document.cookie.indexOf(";",pos2);
	
	pos = document.cookie.indexOf("data", i);
	if(pos == -1){
		break;
	}
	
	
	pos2 = document.cookie.indexOf("=",pos);
	if(pos2 == -1){
		break;
	}
			
	dataAtual = document.cookie.substring(pos,pos2);
	dataAtual = getCookie(dataAtual);

	
	pos = document.cookie.indexOf("mensagem", i);
	if(pos == -1){
		break;
	}	
	pos2 = document.cookie.indexOf("=",pos);
	if(pos2 == -1){
		break;
	}		
	msgAtual = document.cookie.substring(pos,pos2);
	msgAtual = getCookie(msgAtual);
	
	i = document.cookie.indexOf(";",pos2);
	
	//document.write("<td><label onclick=\"editarDado(0);\" ><a href=\"novoContato.html\">" + numString + "</a></label></td><td>" + dataAtual + "</td><td>" + autorAtual + "</td><td>" + msgAtual + "</td></tr>");
	//document.write("<td>" + numString + "</td><td>" + dataAtual + "</td><td>" + autorAtual + "</td><td>" + msgAtual + "</td><td></td></tr>");
	//document.write("<td><button onclick=\"deletarContato(this);\" value=" + numString + ">" + numString + "</label></td><td>" + dataAtual + "</td><td>" + autorAtual + "</td><td>" + msgAtual + "</td></tr>");
	document.write("<td>" + numString + "</td><td>" + dataAtual + "</td><td>" + autorAtual + "</td><td>" + msgAtual + "</td><td><button onclick=\"deletarContato(this);\" value=" + numString + ">Deletar</label></tr>");	
}
document.write("</table><br><a href=\"novoContato.html\">Adicionar novo Contato</a><button onclick=\"deleteAllCookies();\">Deletar todos os Contatos</button></body></html>");

</script>
</head>
